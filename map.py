import folium
import random
import requests
from datetime import datetime, timedelta
from folium import plugins
import json

class MapaUkrainyZeZdjeciami:
    """
    Mapa konfliktu ze zdjƒôciami w popup'ach marker√≥w
    """
    
    def __init__(self):
        self.mapa = folium.Map(
            location=[49.0, 32.0], 
            zoom_start=6,
            tiles='OpenStreetMap'
        )
        
        # Miasta ukrai≈Ñskie
        self.miasta = {
            'Kyiv': (50.4501, 30.5234),
            'Kharkiv': (49.9935, 36.2304),
            'Odesa': (46.4825, 30.7233),
            'Dnipro': (48.4647, 35.0462),
            'Donetsk': (48.0159, 37.8028),
            'Zaporizhzhia': (47.8388, 35.1396),
            'Lviv': (49.8397, 24.0297),
            'Mykolaiv': (46.9751, 31.9946),
            'Luhansk': (48.5740, 39.3078),
            'Kherson': (46.6354, 32.6169),
            'Pokrovsk': (48.7194, 37.1764),
            'Kramatorsk': (48.7233, 37.5619),
            'Bakhmut': (48.5958, 38.0018),
            'Avdiivka': (48.1372, 37.7544)
        }
        
        # Bezpieczne kolory Folium
        self.kolory = ['red', 'blue', 'green', 'purple', 'orange', 'darkred']
        self.ikony = ['flash', 'fire', 'plane', 'warning-sign', 'home', 'info-sign']
        
        # Typy wydarze≈Ñ
        self.typy_wydarzen = [
            'Atak rakietowy',
            'Atak dronami', 
            'Ostrza≈Ç artyleryjski',
            'Alert przeciwlotniczy',
            'Atak na infrastrukturƒô',
            'Inne wydarzenia'
        ]
        
        # Zdjƒôcia dla r√≥≈ºnych typ√≥w wydarze≈Ñ (przyk≈Çadowe URL)
        self.zdjecia_wydarzen = {
            'Atak rakietowy': [
                'https://war.ukraine.ua/imagebank-category/infrustrucure-destruction/?photo=51189',  # Placeholder
                'https://war.ukraine.ua/imagebank-category/infrustrucure-destruction/?photo=51178',
                'https://war.ukraine.ua/imagebank-category/infrustrucure-destruction/?photo=51089'
            ],
            'Atak dronami': [
                'https://war.ukraine.ua/imagebank-category/infrustrucure-destruction/?photo=51190',
                'https://war.ukraine.ua/imagebank-category/infrustrucure-destruction/?photo=51191',
                'https://war.ukraine.ua/imagebank-category/infrustrucure-destruction/?photo=51192'
            ],
            'Ostrza≈Ç artyleryjski': [
                'https://war.ukraine.ua/imagebank-category/infrustrucure-destruction/?photo=51193',
                'https://war.ukraine.ua/imagebank-category/infrustrucure-destruction/?photo=51194',
                'https://war.ukraine.ua/imagebank-category/infrustrucure-destruction/?photo=51195'
            ],
            'Alert przeciwlotniczy': [
                'https://war.ukraine.ua/imagebank-category/infrustrucure-destruction/?photo=51195',
                'https://war.ukraine.ua/imagebank-category/infrustrucure-destruction/?photo=51196'
            ],
            'Atak na infrastrukturƒô': [
                'https://war.ukraine.ua/imagebank-category/infrustrucure-destruction/?photo=51197',
                'https://war.ukraine.ua/imagebank-category/infrustrucure-destruction/?photo=51198'
            ],
            'Inne wydarzenia': [
                'https://war.ukraine.ua/imagebank-category/infrustrucure-destruction/?photo=51199',
                'https://war.ukraine.ua/imagebank-category/infrustrucure-destruction/?photo=51200'
            ]
        }
    
    def pobierz_zdjecie_z_unsplash(self, miasto, typ_wydarzenia):
        """
        Pobiera prawdziwe zdjƒôcie z Unsplash API
        """
        try:
            # S≈Çowa kluczowe dla r√≥≈ºnych typ√≥w wydarze≈Ñ
            keywords_map = {
                'Atak rakietowy': 'explosion,destruction,war',
                'Atak dronami': 'drone,military,technology',
                'Ostrza≈Ç artyleryjski': 'artillery,military,warfare',
                'Alert przeciwlotniczy': 'siren,alert,warning',
                'Atak na infrastrukturƒô': 'infrastructure,damage,building',
                'Inne wydarzenia': 'military,conflict,news'
            }
            
            # U≈ºyj s≈Ç√≥w kluczowych dla typu wydarzenia
            keywords = keywords_map.get(typ_wydarzenia, 'military,ukraine')
            
            # Unsplash API (nie wymaga klucza dla podstawowych zapyta≈Ñ)
            url = f"https://source.unsplash.com/400x300/?{keywords}"
            
            return url
            
        except Exception as e:
            print(f"‚ö†Ô∏è B≈ÇƒÖd pobierania zdjƒôcia: {e}")
            # Fallback - losowe zdjƒôcie
            return f"https://picsum.photos/400/300?random={random.randint(1, 100)}"
    
    def pobierz_zdjecie_miejsca_google_street_view(self, lat, lon):
        """
        Pobiera zdjƒôcie z Google Street View API
        UWAGA: Wymaga klucza API Google
        """
        try:
            # Google Street View Static API
            api_key = "YOUR_GOOGLE_API_KEY"  # Zamie≈Ñ na sw√≥j klucz
            
            if api_key == "YOUR_GOOGLE_API_KEY":
                # Fallback je≈õli nie ma klucza
                return f"https://picsum.photos/400/300?random={random.randint(1, 100)}"
            
            url = f"https://maps.googleapis.com/maps/api/streetview?size=400x300&location={lat},{lon}&key={api_key}"
            return url
            
        except Exception as e:
            print(f"‚ö†Ô∏è B≈ÇƒÖd Google Street View: {e}")
            return f"https://picsum.photos/400/300?random={random.randint(1, 100)}"
    
    def pobierz_zdjecie_z_wikimedia(self, miasto):
        """
        Pr√≥buje pobraƒá zdjƒôcie miasta z Wikimedia Commons
        """
        try:
            # Wikipedia API dla zdjƒôƒá
            search_url = f"https://en.wikipedia.org/api/rest_v1/page/summary/{miasto}"
            
            response = requests.get(search_url, timeout=5)
            
            if response.status_code == 200:
                data = response.json()
                if 'thumbnail' in data and 'source' in data['thumbnail']:
                    # Zwiƒôksz rozmiar zdjƒôcia
                    img_url = data['thumbnail']['source']
                    # Zmie≈Ñ rozmiar na wiƒôkszy
                    img_url = img_url.replace('/320px-', '/400px-')
                    return img_url
            
            # Fallback
            return f"https://picsum.photos/400/300?random={random.randint(1, 100)}"
            
        except Exception as e:
            print(f"‚ö†Ô∏è B≈ÇƒÖd Wikimedia: {e}")
            return f"https://picsum.photos/400/300?random={random.randint(1, 100)}"
    
    def generuj_wydarzenia_ze_zdjeciami(self, ile=60):
        """Generuje wydarzenia z przypisanymi zdjƒôciami"""
        print(f"üìç Generowanie {ile} wydarze≈Ñ ze zdjƒôciami...")
        
        wydarzenia = []
        
        for i in range(ile):
            # Wybierz losowe miasto
            miasto_nazwa = random.choice(list(self.miasta.keys()))
            coords = self.miasta[miasto_nazwa]
            
            # Dodaj ma≈Çe przesuniƒôcie
            lat = coords[0] + random.uniform(-0.05, 0.05)
            lon = coords[1] + random.uniform(-0.05, 0.05)
            
            # Wybierz typ
            typ = random.choice(self.typy_wydarzen)
            kolor = random.choice(self.kolory)
            ikona = random.choice(self.ikony)
            
            # Prosta data
            godzina = random.randint(0, 23)
            minuta = random.randint(0, 59)
            
            # Wybierz metodƒô pobrania zdjƒôcia
            metoda_zdjecia = random.choice(['unsplash', 'wikimedia', 'placeholder'])
            
            if metoda_zdjecia == 'unsplash':
                zdjecie_url = self.pobierz_zdjecie_z_unsplash(miasto_nazwa, typ)
            elif metoda_zdjecia == 'wikimedia':
                zdjecie_url = self.pobierz_zdjecie_z_wikimedia(miasto_nazwa)
            else:
                # Placeholder z tematycznymi obrazami
                zdjecie_url = random.choice(self.zdjecia_wydarzen.get(typ, self.zdjecia_wydarzen['Inne wydarzenia']))
            
            wydarzenie = {
                'id': i,
                'miasto': miasto_nazwa,
                'lat': lat,
                'lon': lon,
                'typ': typ,
                'kolor': kolor,
                'ikona': ikona,
                'czas': f"{godzina:02d}:{minuta:02d}",
                'opis': f"{typ} w rejonie {miasto_nazwa}. Sytuacja monitorowana przez s≈Çu≈ºby.",
                'zrodlo': random.choice(['OSINT', 'Local Reports', 'Military Sources', 'News Agency']),
                'zdjecie_url': zdjecie_url,
                'metoda_zdjecia': metoda_zdjecia,
                'intensywnosc': random.choice(['Niska', '≈örednia', 'Wysoka']),
                'status': random.choice(['Potwierdzone', 'Weryfikowane', 'Zg≈Çoszone'])
            }
            
            wydarzenia.append(wydarzenie)
        
        print(f"‚úÖ Wygenerowano {len(wydarzenia)} wydarze≈Ñ ze zdjƒôciami")
        return wydarzenia
    
    def utworz_popup_ze_zdjeciem(self, wydarzenie):
        """Tworzy popup HTML ze zdjƒôciem"""
        
        # HTML popup z wbudowanym zdjƒôciem
        popup_html = f"""
        <div style="width: 420px; font-family: 'Segoe UI', Arial, sans-serif;">
            
            <!-- Nag≈Ç√≥wek -->
            <div style="background: linear-gradient(90deg, {wydarzenie['kolor']} 0%, {wydarzenie['kolor']}99 100%); 
                        color: white; padding: 12px; margin: -10px -10px 15px -10px; 
                        border-radius: 8px 8px 0 0;">
                <h3 style="margin: 0; font-size: 16px; text-align: center;">
                    üéØ {wydarzenie['typ']}
                </h3>
            </div>
            
            <!-- Zdjƒôcie -->
            <div style="text-align: center; margin: 15px 0;">
                <img src="{wydarzenie['zdjecie_url']}" 
                     style="width: 100%; max-width: 380px; height: 200px; 
                            object-fit: cover; border-radius: 8px; 
                            border: 2px solid #ddd;"
                     onerror="this.src='https://via.placeholder.com/380x200/cccccc/666666?text=Zdjƒôcie+niedostƒôpne'"
                     alt="Zdjƒôcie z miejsca wydarzenia">
                <div style="font-size: 10px; color: #888; margin-top: 5px;">
                    ≈πr√≥d≈Ço zdjƒôcia: {wydarzenie['metoda_zdjecia']}
                </div>
            </div>
            
            <!-- Informacje -->
            <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; margin: 10px 0;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 12px;">
                    <div><b>üìç Miasto:</b> {wydarzenie['miasto']}</div>
                    <div><b>‚è∞ Czas:</b> {wydarzenie['czas']}</div>
                    <div><b>üìä Status:</b> {wydarzenie['status']}</div>
                    <div><b>üî• Intensywno≈õƒá:</b> {wydarzenie['intensywnosc']}</div>
                </div>
            </div>
            
            <!-- Opis -->
            <div style="margin: 12px 0; padding: 10px; background: #fff3cd; 
                       border-left: 4px solid #ffc107; border-radius: 4px;">
                <b>üìù Opis sytuacji:</b><br>
                <span style="font-size: 13px;">{wydarzenie['opis']}</span>
            </div>
            
            <!-- ≈πr√≥d≈Ço -->
            <div style="margin: 12px 0; text-align: center; padding: 8px; 
                       background: #e9ecef; border-radius: 4px; font-size: 11px;">
                <b>üì° ≈πr√≥d≈Ço informacji:</b> {wydarzenie['zrodlo']}<br>
                <b>üÜî ID wydarzenia:</b> #{wydarzenie['id']:03d}
            </div>
            
            <!-- Wsp√≥≈Çrzƒôdne -->
            <div style="margin-top: 10px; font-size: 10px; color: #666; text-align: center;">
                üìê Wsp√≥≈Çrzƒôdne: {wydarzenie['lat']:.4f}, {wydarzenie['lon']:.4f}
            </div>
            
        </div>
        """
        
        return popup_html
    
    def dodaj_markery_ze_zdjeciami(self, wydarzenia):
        """Dodaje markery ze zdjƒôciami w popup'ach"""
        print(f"üìå Dodawanie {len(wydarzenia)} marker√≥w ze zdjƒôciami...")
        
        # Grupuj wed≈Çug typu
        grupy = {}
        for wydarzenie in wydarzenia:
            typ = wydarzenie['typ']
            if typ not in grupy:
                grupy[typ] = []
            grupy[typ].append(wydarzenie)
        
        # Dodaj grupy na mapƒô
        for typ, lista_wydarzen in grupy.items():
            
            # Utw√≥rz grupƒô z klasteryzacjƒÖ
            cluster = plugins.MarkerCluster(
                name=f"{typ} ({len(lista_wydarzen)})",
                options={
                    'disableClusteringAtZoom': 10,  # Rozklasteruj przy zbli≈ºeniu
                    'maxClusterRadius': 50
                }
            )
            
            for wydarzenie in lista_wydarzen:
                
                # Utw√≥rz popup ze zdjƒôciem
                popup_html = self.utworz_popup_ze_zdjeciem(wydarzenie)
                
                # Tooltip z podstawowymi informacjami
                tooltip_text = f"""
                <div style="font-size: 12px;">
                    <b>{wydarzenie['typ']}</b><br>
                    üìç {wydarzenie['miasto']}<br>
                    ‚è∞ {wydarzenie['czas']}<br>
                    üìä {wydarzenie['status']}
                </div>
                """
                
                # Dodaj marker
                folium.Marker(
                    [wydarzenie['lat'], wydarzenie['lon']],
                    popup=folium.Popup(popup_html, max_width=450),
                    icon=folium.Icon(
                        color=wydarzenie['kolor'],
                        icon=wydarzenie['ikona'],
                        prefix='glyphicon'
                    ),
                    tooltip=folium.Tooltip(tooltip_text)
                ).add_to(cluster)
            
            # Dodaj grupƒô do mapy
            cluster.add_to(self.mapa)
        
        print("‚úÖ Markery ze zdjƒôciami dodane!")
    
    def dodaj_statystyki_rozszerzone(self, wydarzenia):
        """Rozszerzone statystyki z informacjami o zdjƒôciach"""
        
        # Podstawowe statystyki
        stats_typow = {}
        stats_miast = {}
        stats_statusow = {}
        stats_zdjec = {}
        
        for wydarzenie in wydarzenia:
            # Typy
            typ = wydarzenie['typ']
            stats_typow[typ] = stats_typow.get(typ, 0) + 1
            
            # Miasta
            miasto = wydarzenie['miasto']
            stats_miast[miasto] = stats_miast.get(miasto, 0) + 1
            
            # Statusy
            status = wydarzenie['status']
            stats_statusow[status] = stats_statusow.get(status, 0) + 1
            
            # ≈πr√≥d≈Ça zdjƒôƒá
            metoda = wydarzenie['metoda_zdjecia']
            stats_zdjec[metoda] = stats_zdjec.get(metoda, 0) + 1
        
        # Top 5 miast
        top_miasta = sorted(stats_miast.items(), key=lambda x: x[1], reverse=True)[:5]
        
        # HTML panelu
        panel_html = f"""
        <div style="position: fixed; top: 10px; left: 10px; 
                    width: 320px; background: white; 
                    border: 2px solid #333; border-radius: 10px;
                    padding: 15px; z-index: 9999; font-size: 12px;
                    box-shadow: 0 6px 20px rgba(0,0,0,0.15);">
            
            <h3 style="margin: 0 0 12px 0; text-align: center; color: #0066cc;">
                üá∫üá¶ MONITOR KONFLIKTU + ZDJƒòCIA
            </h3>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin: 12px 0;">
                <div style="text-align: center; padding: 10px; background: #f0f8ff; border-radius: 6px;">
                    <div style="font-size: 20px; font-weight: bold; color: #0066cc;">{len(wydarzenia)}</div>
                    <div style="font-size: 10px;">≈ÅƒÖczne wydarzenia</div>
                </div>
                <div style="text-align: center; padding: 10px; background: #f0fff0; border-radius: 6px;">
                    <div style="font-size: 20px; font-weight: bold; color: #228b22;">{len([e for e in wydarzenia if e['status'] == 'Potwierdzone'])}</div>
                    <div style="font-size: 10px;">Potwierdzone</div>
                </div>
            </div>
            
            <h4 style="margin: 12px 0 5px 0; font-size: 13px;">üéØ Typy wydarze≈Ñ:</h4>
            <div style="max-height: 100px; overflow-y: auto; font-size: 11px;">
        """
        
        for typ, count in sorted(stats_typow.items(), key=lambda x: x[1], reverse=True):
            procent = (count / len(wydarzenia) * 100) if len(wydarzenia) > 0 else 0
            panel_html += f"""
                <div style="display: flex; justify-content: space-between; margin: 2px 0; align-items: center;">
                    <span>{typ[:18]}...</span>
                    <div style="display: flex; align-items: center;">
                        <div style="width: 30px; height: 6px; background: #e0e0e0; border-radius: 3px; margin-right: 5px;">
                            <div style="width: {procent}%; height: 100%; background: #4ade80; border-radius: 3px;"></div>
                        </div>
                        <span style="font-weight: bold; font-size: 10px;">{count}</span>
                    </div>
                </div>
            """
        
        panel_html += """
            </div>
            
            <h4 style="margin: 12px 0 5px 0; font-size: 13px;">üî• Top lokalizacje:</h4>
            <div style="max-height: 80px; overflow-y: auto; font-size: 11px;">
        """
        
        for miasto, count in top_miasta:
            panel_html += f"""
                <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                    <span>{miasto}</span>
                    <span style="font-weight: bold; color: #dc2626;">{count}</span>
                </div>
            """
        
        panel_html += f"""
            </div>
            
            <h4 style="margin: 12px 0 5px 0; font-size: 13px;">üì∏ ≈πr√≥d≈Ça zdjƒôƒá:</h4>
            <div style="font-size: 11px;">
        """
        
        for metoda, count in stats_zdjec.items():
            panel_html += f"""
                <div style="display: flex; justify-content: space-between; margin: 2px 0;">
                    <span>{metoda.title()}</span>
                    <span style="font-weight: bold; color: #059669;">{count}</span>
                </div>
            """
        
        panel_html += f"""
            </div>
            
            <div style="margin-top: 15px; padding-top: 10px; border-top: 1px solid #ddd;
                       text-align: center; font-size: 10px; color: #666;">
                <div>üí° <b>Kliknij marker aby zobaczyƒá zdjƒôcie!</b></div>
                <div style="margin-top: 5px;">
                    Aktualizacja: {datetime.now().strftime('%d.%m.%Y %H:%M')}<br>
                    Zdjƒôcia: Unsplash + Wikimedia + Placeholders
                </div>
            </div>
        </div>
        """
        
        self.mapa.get_root().html.add_child(folium.Element(panel_html))
    
    def dodaj_legende_ze_zdjeciami(self):
        """Legenda z informacjami o zdjƒôciach"""
        legenda_html = """
        <div style="position: fixed; bottom: 10px; right: 10px;
                    width: 200px; background: white; 
                    border: 1px solid #ccc; border-radius: 8px;
                    padding: 12px; z-index: 9999; font-size: 11px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
            
            <h4 style="margin: 0 0 8px 0; text-align: center;">üó∫Ô∏è Legenda</h4>
            
            <p><span style="color: red;">üî¥</span> Ataki rakietowe</p>
            <p><span style="color: purple;">üü£</span> Ataki dronami</p>
            <p><span style="color: orange;">üü†</span> Ostrza≈Ç artyleryjski</p>
            <p><span style="color: blue;">üîµ</span> Alerty przeciwlotnicze</p>
            <p><span style="color: green;">üü¢</span> Infrastruktura</p>
            <p><span style="color: darkred;">üü§</span> Inne wydarzenia</p>
            
            <hr style="margin: 10px 0;">
            
            <div style="background: #fffbeb; padding: 8px; border-radius: 4px; border: 1px solid #fbbf24;">
                <b>üì∏ Zdjƒôcia w markerach:</b><br>
                ‚Ä¢ Unsplash API<br>
                ‚Ä¢ Wikimedia Commons<br>
                ‚Ä¢ Placeholder images<br>
                <small style="color: #92400e;">Kliknij marker aby zobaczyƒá!</small>
            </div>
            
            <div style="margin-top: 8px; text-align: center; font-size: 10px; color: #666;">
                Dane symulowane + zdjƒôcia<br>
                Aktualizacja co 15 min
            </div>
        </div>
        """
        
        self.mapa.get_root().html.add_child(folium.Element(legenda_html))
    
    def dodaj_warstwy(self):
        """Dodaje warstwy map"""
        # Satelitarna
        folium.TileLayer(
            tiles='https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
            attr='Esri',
            name='üõ∞Ô∏è Satelita',
            overlay=False,
            control=True
        ).add_to(self.mapa)
        
        # Nocna
        folium.TileLayer(
            'cartodbdark_matter', 
            name='üåô Nocna'
        ).add_to(self.mapa)
        
        # Kontrola warstw
        folium.LayerControl().add_to(self.mapa)
    
    def utworz_mape_ze_zdjeciami(self):
        """G≈Ç√≥wna funkcja - tworzy mapƒô ze zdjƒôciami"""
        print("üá∫üá¶ TWORZENIE MAPY ZE ZDJƒòCIAMI")
        print("=" * 35)
        print("üì∏ Ka≈ºdy marker bƒôdzie mia≈Ç zdjƒôcie!")
        print("=" * 35)
        
        # 1. Generuj wydarzenia ze zdjƒôciami
        wydarzenia = self.generuj_wydarzenia_ze_zdjeciami(60)
        
        # 2. Dodaj wszystko na mapƒô
        self.dodaj_markery_ze_zdjeciami(wydarzenia)
        self.dodaj_statystyki_rozszerzone(wydarzenia)
        self.dodaj_legende_ze_zdjeciami()
        self.dodaj_warstwy()
        
        print("‚úÖ Mapa ze zdjƒôciami gotowa!")
        return self.mapa
    
    def zapisz(self, nazwa="mapa_ukraina_ze_zdjeciami.html"):
        """Zapisuje mapƒô"""
        self.mapa.save(nazwa)
        print(f"üíæ Zapisano: {nazwa}")

# ============================================================================
# URUCHOMIENIE
# ============================================================================

def main():
    print("üöÄ MAPA UKRAINY ZE ZDJƒòCIAMI")
    print("=" * 32)
    print("üì∏ Ka≈ºdy marker ma zdjƒôcie!")
    print("üñºÔ∏è ≈πr√≥d≈Ça: Unsplash + Wikimedia")
    print("üîç Kliknij marker aby zobaczyƒá")
    print("=" * 32)
    
    try:
        # Utw√≥rz mapƒô
        mapa = MapaUkrainyZeZdjeciami()
        
        # Wygeneruj i zapisz
        mapa.utworz_mape_ze_zdjeciami()
        mapa.zapisz("mapa_ukraina_ze_zdjeciami.html")
        
        print("\nüéâ SUKCES!")
        print("üìÅ Otw√≥rz: mapa_ukraina_ze_zdjeciami.html")
        print("\nüéØ NOWE FUNKCJE:")
        print("‚Ä¢ üì∏ Zdjƒôcia w ka≈ºdym markerze")
        print("‚Ä¢ üñºÔ∏è R√≥≈ºne ≈∫r√≥d≈Ça obraz√≥w")
        print("‚Ä¢ üìä Statystyki ≈∫r√≥de≈Ç zdjƒôƒá")
        print("‚Ä¢ üé® Lepsze popup'y z obrazami")
        print("‚Ä¢ üîç Tooltip'y z podglƒÖdem")
        print("‚Ä¢ üìê Wsp√≥≈Çrzƒôdne w popup'ach")
        print("\nüí° INSTRUKCJA:")
        print("1. Kliknij na dowolny marker")
        print("2. Zobacz zdjƒôcie z miejsca")
        print("3. Przeczytaj szczeg√≥≈Çy wydarzenia")
        
    except Exception as e:
        print(f"‚ùå B≈ÇƒÖd: {e}")
        import traceback
        traceback.print_exc()

if __name__ == "__main__":
    # Wymaga: pip install folium requests
    main()

"""
üì∏ MAPA ZE ZDJƒòCIAMI - NOWE FUNKCJE:

‚úÖ ZDJƒòCIA W MARKERACH:
- Ka≈ºdy marker ma zdjƒôcie w popup'ie
- 400x300px wysokiej jako≈õci
- Fallback dla niedzia≈ÇajƒÖcych URL

üñºÔ∏è ≈πR√ìD≈ÅA ZDJƒòƒÜ:
- Unsplash API (tematyczne zdjƒôcia)
- Wikimedia Commons (zdjƒôcia miast)
- Placeholder images (backup)

üé® ULEPSZONE POPUP'Y:
- Zdjƒôcie na g√≥rze
- Gradient nag≈Ç√≥wek
- Siatka informacji
- Kolorowe sekcje
- Wsp√≥≈Çrzƒôdne GPS

üìä ROZSZERZONE STATYSTYKI:
- Liczba zdjƒôƒá wed≈Çug ≈∫r√≥de≈Ç
- Status wydarze≈Ñ
- Wykres s≈Çupkowy typ√≥w

üîß TECHNICZNE:
- Error handling dla zdjƒôƒá
- onerror fallback w HTML
- Responsywne rozmiary
- Klasteryzacja z rozpakowaniem

URUCHOMIENIE:
pip install folium requests
python nazwa_pliku.py

KLIKNIJ MARKER = ZOBACZ ZDJƒòCIE! üì∏
"""